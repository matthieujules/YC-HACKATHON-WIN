<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ray-Ban Crypto Payments</title>
    <link rel="stylesheet" href="styles.css">

    <!-- Face-api.js -->
    <script defer src="https://cdn.jsdelivr.net/npm/@vladmandic/face-api/dist/face-api.min.js"></script>

    <!-- MediaPipe Hands -->
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Ray-Ban Crypto Payments</h1>
            <p class="subtitle">Handshake-Activated Transactions</p>
            <div class="mode-toggle">
                <button id="modeEnroll" class="mode-btn active">Enroll</button>
                <button id="modeTransaction" class="mode-btn">Transaction</button>
            </div>
        </header>

        <main>
            <!-- Enrollment Mode -->
            <div id="enrollmentMode" class="mode-section">
                <h2>Enroll New Person</h2>
                <div class="enrollment-container">
                    <div class="video-wrapper">
                        <video id="enrollVideo" autoplay playsinline></video>
                        <canvas id="enrollCanvas"></canvas>
                        <div id="faceOverlay" class="face-overlay"></div>
                    </div>

                    <div class="enrollment-form">
                        <div class="form-group">
                            <label for="personName">Name:</label>
                            <input type="text" id="personName" placeholder="Enter person's name" />
                        </div>
                        <div class="form-group">
                            <label for="walletAddress">Wallet Address:</label>
                            <input type="text" id="walletAddress" placeholder="0x..." />
                        </div>
                        <div class="form-group">
                            <label>Captured Photos: <span id="photoCount">0/5</span></label>
                            <div id="photoPreview" class="photo-preview"></div>
                        </div>
                        <div class="button-group">
                            <button id="capturePhoto" class="btn btn-accent">Capture Photo</button>
                            <button id="saveEnrollment" class="btn btn-primary" disabled>Save Person</button>
                            <button id="resetEnrollment" class="btn btn-secondary">Reset</button>
                        </div>
                    </div>
                </div>

                <div class="enrolled-people">
                    <h3>Enrolled People</h3>
                    <div id="enrolledList"></div>
                </div>
            </div>

            <!-- Transaction Mode -->
            <div id="transactionMode" class="mode-section" style="display: none;">
                <div class="video-wrapper">
                    <video id="transactionVideo" autoplay playsinline></video>
                    <canvas id="transactionCanvas"></canvas>
                    <canvas id="handCanvas" class="overlay-canvas"></canvas>
                </div>

                <!-- Detection Status Panel -->
                <div class="detection-panel">
                    <div class="detection-card">
                        <div class="detection-icon" id="faceIcon">üë§</div>
                        <div class="detection-info">
                            <h3>Person Recognition</h3>
                            <p id="personStatus">Waiting for person...</p>
                            <p id="personDetails" class="details"></p>
                        </div>
                    </div>

                    <div class="detection-card">
                        <div class="detection-icon" id="audioIcon">üé§</div>
                        <div class="detection-info">
                            <h3>Verbal Agreement</h3>
                            <p id="audioStatus">Listening...</p>
                            <p id="audioTranscript" class="details"></p>
                        </div>
                    </div>

                    <div class="detection-card">
                        <div class="detection-icon" id="handshakeIcon">ü§ù</div>
                        <div class="detection-info">
                            <h3>Handshake Detection</h3>
                            <p id="handshakeStatus">Waiting for handshake...</p>
                            <p id="handshakeDetails" class="details"></p>
                        </div>
                    </div>
                </div>

                <!-- Transaction Panel -->
                <div id="transactionPanel" class="transaction-panel" style="display: none;">
                    <h2>Ready to Transact!</h2>
                    <div class="transaction-details">
                        <p><strong>To:</strong> <span id="txRecipient"></span></p>
                        <p><strong>Wallet:</strong> <span id="txWallet"></span></p>
                        <p><strong>Amount:</strong> <span id="txAmount"></span></p>
                    </div>
                    <div class="button-group">
                        <button id="confirmTransaction" class="btn btn-primary btn-large">Confirm Transaction</button>
                        <button id="cancelTransaction" class="btn btn-secondary">Cancel</button>
                    </div>
                </div>

                <!-- Controls -->
                <div class="controls">
                    <button id="startTransaction" class="btn btn-primary">Start Transaction Mode</button>
                    <button id="stopTransaction" class="btn btn-secondary" disabled>Stop</button>
                </div>
            </div>
        </main>

        <footer>
            <p class="status" id="status">Initialize camera to begin</p>
        </footer>
    </div>

    <script src="app.js"></script>
</body>
</html>
